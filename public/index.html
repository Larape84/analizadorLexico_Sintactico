<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Analizador Lexico y Sintactico</title>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>

   


</head>
<body>
    <div class="container" style="max-width: 800px;">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <div align="center" ><img src="./img/logo.png" width="158" height="160" ></div>
        <div class="text-center" style="margin: 20px 0px 20px 0px;">
            <a href="" target="_blank">Analizador Lexico y Sintactico</a><br>
            <span class="text-secondary">sintaxis para las variables GRANT y REVOKE SQL</span>
            <br>
            <span class="text-secondary col-mb-6">Introduzca el codigo a analizar</span>
            <textarea class="form-control" id="inputcodigo" name="inputcodigo" rows="5" type="text" onKeyUp="document.getElementById(this.id).value=document.getElementById(this.id).value.toUpperCase()"></textarea>
            </div>

            <button type="button" class="btn btn-primary" onclick="analizar()">Analizar</button>
            <button type="button" class="btn btn-danger" onclick="borrar()">Borrar</button>
            <!-- Button trigger modal -->
            <button type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
              Ver ejemplos de Sintaxis
            </button>

<!-- Modal -->
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Sintasis GRANT y REVOKE SQL</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>instrucciones SQl para las sentencias GRANT y REVOKE</p> 




      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-success" onclick="insertar()">Insertar Ejemplos</button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>

      </div>
    </div>
  </div>
</div>

            <br><br>




<div  id="ocultarLexico" name="ocultarLexico" style="display: none;">
            <div class="container_lexico">
                <h4>Analizador Lexico</h4>
                <div id="aLexico">
                  <table class="table table-bordered">
                    <thead class="thead-dark">
                      <tr>
                        <th class="h6" scope="col">nro</th>
                        <th class="h6" scope="col">nombre</th>
                        <th class="h6"scope="col">tipo</th>
                        <th class="h6"scope="col">codigo</th>
                      </tr>
                    </thead>
                    <tbody id="cuerpoTabla"></tbody>
                  </table>
                </div>
              </div>
            </div>
<script type="text/javascript">

function insertar(){

document.querySelectorAll("table tbody tr").forEach(function(e){e.remove()})
document.getElementById("inputcodigo").value="REVOKE READ_WRITE ON MiEsquema1;\nGRANT EXECUTE ON dbo.uspGetBillOfMaterials TO newrole;";
$('#ocultarLexico').css('display', 'none');
$('#ocularSintactico').css('display', 'none');
document.querySelector("#staticBackdrop > div > div > div.modal-footer > button.btn.btn-secondary").click();
}

 
let lexemas;
lexemas=[

  {
      "nombre": "IF",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
    "nombre": "ON",
    "tipo": "reservada",
    "codigo":"100"
},
  
  {
      "nombre": "VAR",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "CONST",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "LET",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "SWITCH",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "CASE",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "IF",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "ELSE",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "FOR",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "WHILE",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "PARSEFLOAT",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "BREAK",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "TEXTCONTENT",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "INNERHTML",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "DOCUMENT",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "getElementById",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "RETURN",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "CONTINUE",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "TRY",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "CATCH",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "CONSOLE",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": "LOG",
      "tipo": "reservada",
      "codigo":"100"
  },
  {
      "nombre": 0,
      "tipo": "numero",
      "codigo":"102"
  },
  {
      "nombre": 1,
      "tipo": "numero",
      "codigo":"102"
  },
  {
      "nombre": 2,
      "tipo": "numero",
      "codigo":"102"
  },
  {
      "nombre": 3,
      "tipo": "numero",
      "codigo":"102"
  },
  {
      "nombre": 4,
      "tipo": "numero",
      "codigo":"102"
  },
  {
      "nombre": 5,
      "tipo": "numero",
      "codigo":"102"
  },
  {
      "nombre": 6,
      "tipo": "numero",
      "codigo":"102"
  },
  {
      "nombre": 7,
      "tipo": "numero",
      "codigo":"102"
  },
  {
      "nombre": 8,
      "tipo": "numero",
      "codigo":"102"
  },
  {
      "nombre": 9,
      "tipo": "numero",
      "codigo":"102"
  },
  {
      "nombre": "(",
      "tipo": "simbolo",
      "codigo":"103"
  },
  {
      "nombre": ")",
      "tipo": "simbolo",
      "codigo":"103"
  },
  {
      "nombre": "{",
      "tipo": "simbolo",
      "codigo":"103"
  },
  {
      "nombre": "=",
      "tipo": "simbolo",
      "codigo":"103"
  },
  {
      "nombre": "==",
      "tipo": "simbolo",
      "codigo":"103"
  },
  {
      "nombre": "===",
      "tipo": "simbolo",
      "codigo":"103"
  },
  {
      "nombre": ">=",
      "tipo": "simbolo",
      "codigo":"103"
  },
  {
      "nombre": "<=",
      "tipo": "simbolo",
      "codigo":"103"
  },
  {
      "nombre": "!=",
      "tipo": "simbolo",
      "codigo":"103"
  },
  {
      "nombre": "!==",
      "tipo": "simbolo",
      "codigo":"103"
  },
  {
      "nombre": ";",
      "tipo": "simbolo",
      "codigo":"103"
  },
  {
      "nombre": ":",
      "tipo": "simbolo",
      "codigo":"103"
  },
  {
      "nombre": "}",
      "tipo": "simbolo",
      "codigo":"103"
  },
  {
      "nombre": ".",
      "tipo": "simbolo",
      "codigo":"103"
  },
  {
      "nombre": "+",
      "tipo": "operador",
      "codigo":"104"
  },
  {
      "nombre": "-",
      "tipo": "operador",
      "codigo":"104"
  },
  {
      "nombre": "*",
      "tipo": "operador",
      "codigo":"104"
  },
  {
      "nombre": "/",
      "tipo": "operador",
      "codigo":"104"
  },
  {
      "nombre": "%",
      "tipo": "operador",
      "codigo":"104"
  }
  
];

function borrar(){

  document.querySelectorAll("table tbody tr").forEach(function(e){e.remove()})
  document.getElementById("inputcodigo").value="";
  $('#ocultarLexico').css('display', 'none');
  $('#ocularSintactico').css('display', 'none');


}

function analizar(){

if (document.getElementById("inputcodigo").value==""){
  alert ("Por favor ingresar instruccion(es)");
  return;
}

const str = document.getElementById("inputcodigo").value;


if (str.includes(';')==false){
  alert ("Por favor debe separar cada instruccion mediante simbolo ( ; )");
  return;
}
  
document.querySelectorAll("table tbody tr").forEach(function(e){e.remove()})

    $('#ocultarLexico').css('display', 'block');
    $('#ocularSintactico').css('display', 'block');


let Analizadorlexico =[];

Analizadorlexico = document.getElementById("inputcodigo").value;


let tokens = [];

      /* en cada linea separamos los simbolos*/
      Analizadorlexico = Analizadorlexico.trim();
      Analizadorlexico = Analizadorlexico.replaceAll(';',' ; ');
      Analizadorlexico = Analizadorlexico.replaceAll('+',' + ');
      Analizadorlexico = Analizadorlexico.replaceAll('(',' ( ');
      Analizadorlexico = Analizadorlexico.replaceAll(')',' ) ');
      Analizadorlexico = Analizadorlexico.replaceAll('>=',' >= ');
      Analizadorlexico = Analizadorlexico.replaceAll('<=',' <= ');
      Analizadorlexico = Analizadorlexico.replaceAll('=',' = ');
      Analizadorlexico = Analizadorlexico.replaceAll(' =  = ',' == ');
      Analizadorlexico = Analizadorlexico.replaceAll(' ==  = ',' === ');
      
      Analizadorlexico = Analizadorlexico.replaceAll('<',' < ');
      Analizadorlexico = Analizadorlexico.replaceAll('>',' > ');
      Analizadorlexico = Analizadorlexico.replaceAll(';',' ; ');

      

    
    /* separamos cada linea por los espacios */
    let listaDePalabras = [];
     listaDePalabras = Analizadorlexico.split(/\s+/gm);
     var index = listaDePalabras.indexOf("");
        if (index > -1) {
          listaDePalabras.splice(index, 1);
      }


  n=0;
  nointeracciones=[];
  t=1;
  let resultado="";
  let resultadoCodigo="";

  
  

  const $cuerpoTabla = document.querySelector("#cuerpoTabla");
    
  listaDePalabras.forEach(listaDePalabra => {
    if (listaDePalabra!=undefined && listaDePalabra!=''){
    const $tr = document.createElement("tr");
   
    let $vuelta = document.createElement("td");
    $vuelta.textContent = t; 
    $tr.appendChild($vuelta);
    t++;
    
    let $nombreconjunto1 = document.createElement("td");
    $nombreconjunto1.textContent = listaDePalabras[n];
    $tr.appendChild($nombreconjunto1);
    

    lexemas.forEach(object =>{
      console.log(object.nombre);
      console.log(listaDePalabras[n]);

    if(object.nombre == listaDePalabras[n]){
        resultado= object.tipo;
        resultadoCodigo= object.codigo;
        //alert (resultado);
    }
    });

    if(parseInt(listaDePalabras[n])>1 ||parseInt(listaDePalabras[n])<=1){
        resultado= 'numero';
        resultadoCodigo= '102';
        //alert (resultado);
    };

    if(resultado==''){
        resultado= 'identificador';
        resultadoCodigo= '101';
        //alert (resultado);
    };

    let $selectorOperacion = document.createElement("td");
    $selectorOperacion.textContent = resultado;
    $tr.appendChild($selectorOperacion);
   
   

    let $nombreconjunto2 = document.createElement("td");
    $nombreconjunto2.textContent = resultadoCodigo;
    $tr.appendChild($nombreconjunto2);
    n++;
    $cuerpoTabla.appendChild($tr);}

    resultado="";
    resultadoCodigo="";

    });




    let sintaxis = [];
    sintaxis = Analizadorlexico.split(/(;)+/gm);
     var index = sintaxis.indexOf('');
        if (index > -1) {
          sintaxis.splice(index, 1);
      }

    
      


  n=0;
  nointeracciones=[];
  t=1;
  let resultado2="";

    const $cuerpoTabla2 = document.querySelector("#cuerpoTabla2");
    
    sintaxis.forEach(arreglosintaxis => {

      sintaxis[n] = sintaxis[n].replaceAll('\n',' ');
      sintaxis[n] = sintaxis[n].replaceAll(/\s+/gm,' ');
      sintaxis[n] = sintaxis[n].trim();

      if (sintaxis[n]!=undefined && sintaxis[n]!='' && sintaxis[n]!=';' && sintaxis[n]!="" && sintaxis[n]!='  ') {
      const $tr = document.createElement("tr");
     
      let $vuelta = document.createElement("td");
      $vuelta.textContent = t; 
      $tr.appendChild($vuelta);
      t++;
      
      let $nombreconjunto1 = document.createElement("td");
      $nombreconjunto1.textContent = sintaxis[n];
      $tr.appendChild($nombreconjunto1);
      
      
  var m = sintaxis[n];
  var expreg = new RegExp(/(REVOKE READ_WRITE ON MiEsquema1)|(GRANT EXECUTE ON dbo.uspGetBillOfMaterials TO newrole)/gmi);
  
  if(expreg.test(m)){
    resultado2='sintaxis correcta'}
  else{  resultado2='sintaxis no reconocida'}

      let $selectorOperacion = document.createElement("td");
      $selectorOperacion.textContent =resultado2;
      $tr.appendChild($selectorOperacion);
  
      
      $cuerpoTabla2.appendChild($tr);

      resultado2="";
        //console.log(sintaxis);
    }
      n++;
  
      });













}
</script>



<br>
<div id="ocularSintactico" name="ocularSintactico" style="display: none;"> 
<div class="container_Sintactico">
  <h4>Analizador Sintactico</h4>
  <div id="aLexico">
    <table class="table table-bordered">
      <thead class="thead-dark">
        <tr>
          <th class="h6 col-2" scope="col">Instruccion</th>
          <th class="h6 col-6" scope="col">Sintaxis</th>
          <th class="h6 col-4"scope="col">Manejador Error</th>
        </tr>
      </thead>
      <tbody id="cuerpoTabla2"></tbody>
    </table>
  </div>
</div>
</div>




</body>
</html>